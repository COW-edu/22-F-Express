# 섹션 8, 9

### 라우팅이란

라우팅은 네트워크에서 경로를 선택하는 프로세스. 컴퓨터 네트워크는 *노드*
라고 하는 여러 시스템과 이러한 노드를 연결하는 경로 또는 링크로 구성됨. 상호 연결된 네트워크에서 두 노드 간의 통신은 여러 경로를 통해 이루어질 수 있음.

**라우팅은 미리 정해진 규칙을 사용하여 최상의 경로를 선택하는 프로세스이다.**

### 라우팅이 중요한 이유

라우팅은 네트워크 통신의 효율성을 높임. 네트워크 통신 장애가 발생하면 웹 사이트 페이지가 로드될 때까지 사용자가 기다리는 시간이 길어짐. 또한 웹 사이트 서버에서 많은 수의 사용자를 처리하지 못해 서버의 작동이 중단될 수 있음. 라우팅은 네트워크가 정체 없이 최대한 많은 용량을 사용할 수 있도록 데이터 트래픽을 관리함으로써, 네트워크 장애를 최소화해 줌.

### 라우터란

라우터는 컴퓨팅 디바이스와 네트워크를 다른 네트워크에 연결하는 네트워킹 디바이스. 

- 경로 결정
    - 라우터는 소스에서 대상으로 이동하는 데이터의 경로를 결정. 지연, 용량 및 속도와 같은 네트워크 지표를 분석하여 최상의 경로를 찾으려고 시도.
- 데이터 전달
    - 라우터는 선택한 경로의 다음 디바이스로 데이터를 전달하여 최종적으로 대상에 도달하도록 함. 디바이스와 라우터는 동일한 네트워크에 있거나 서로 다른 네트워크에 있을 수 있음.
- 로드 밸런싱
    - 경우에 따라 라우터가 여러 경로를 사용하여 동일한 데이터 패킷의 여러 사본을 전송할 수도 있음. 이 방법을 통해 데이터 손실로 인한 오류를 줄이고 이중화를 구현하고 트래픽 볼륨을 관리함.

### 라우팅 작동 원리

데이터는 데이터 패킷의 형태로 네트워크를 통해 이동. 각 데이터 패킷에는 패킷의 의도된 대상에 대한 정보가 포함된 헤더가 있음. 패킷이 대상으로 이동하는 동안 여러 라우터가 패킷을 여러 번 라우팅할 수 있음. 라우터는 수백만 개의 패킷에 대해 초당 수백만 번 이 프로세스를 수행.

데이터 패킷이 도착하면 라우터는 먼저 라우팅 테이블에서 그 주소를 찾음. 이는 목적지까지 가는 데 가장 적합한 버스 노선을 찾기 위해 버스 시간표를 참조하는 승객에 비유할 수 있음. 그런 다음 라우터는 패킷을 네트워크의 다음 지점으로 전달하거나 이동.

ex) 사무실 네트워크의 컴퓨터에서 웹 사이트를 방문하면, 데이터 패킷이 먼저 사무실 네트워크 라우터로 이동함. 라우터가 헤더 패킷을 조회하고 패킷 대상을 결정합니다. 그런 다음 내부 테이블을 조회하고, 네트워크 자체 내에서 패킷을 다음 라우터로 전달하거나 프린터와 같은 다른 디바이스로 전달함.

### 라우팅 유형

- 정적 라우팅
    - 정적 라우팅에서는 네트워크 관리자가 정적 테이블을 사용하여 네트워크 경로를 수동으로 구성하고 선택함. 정적 라우팅은 네트워크 설계나 파라미터가 일정하게 유지될 것으로 예상되는 경우에 유용함.
    - 이 라우팅 기법에서는 정적 특성으로 인해 네트워크 정체와 같은 단점이 나타날 수 있음. 링크에서 장애가 발생할 경우에 대비해 관리자가 대체 경로를 구성할 수도 있지만, 일반적으로 정적 라우팅은 네트워크의 적응성과 유연성을 저하시켜 네트워크 성능을 제한함
- 동적 라우팅
    - 동적 라우팅에서 라우터는 실제 네트워크 조건에 따라 런타임에 라우팅 테이블을 만들고 업데이트함. 동적 라우팅 테이블을 만들고 유지 관리하고 업데이트하는 규칙 집합인 동적 라우팅 프로토콜을 사용하여 소스에서 대상까지 가장 빠른 경로를 찾으려고 시도함.
    - 동적 라우팅의 가장 큰 장점은 트래픽 볼륨, 대역폭, 네트워크 장애 등 변화하는 네트워크 조건에 대응한다는 것.

### 라우팅 프로토콜

라우팅 프로토콜은 라우터가 패킷을 식별하고 네트워크 경로를 따라 전달하는 방법을 지정하는 규칙 세트.

- 내부 게이트웨이 프로토콜
    - 자율 시스템을 평가, 라우팅과 관련한 결정을 내림
        - 홉수 또는 소스와 대상 간의 라우터 수
        - 지연 또는 소스에서 대상으로 데이터를 전송하는 데 걸린 시간
        - 대역폭 또는 소스와 대상 간의 링크 용량
    - 예시
        - Routing Information Protocol : 홉 수를 기준으로 네트워크 간의 최단 경로를 결정. 대규모 네트워크를 구현하는 데 적합하지 않기 때문에 현재는 사용되지 않는 레거시 프로토콜
        - Open Shortest Path First 프로토콜 : 자율 시스템의 다른 모든 라우터에서 정보를 수집하여 데이터 패킷의 대상까지 가장 짧고 빠른 경로를 식별함.
- 외부 게이트웨이 프토코콜
    - Border Gateway Protocol : 인터넷을 통한 통신을 정의. 가장 가까운 ASN을 추적하고 대상 주소를 해당 ASN에 매핑하는 방식으로 작동.
    

## POST 요청으로 데이터 전달

post 요청에서는 보통 요청 본문을 사용. (제품을 추가할 때도 사용한 것)

```jsx
//add-detail.ejs
<form action="/cart" method="post">
	<button class="btn" type="submit">Add to Cart</button>
	<input type="hidden" name="productId" value="<%= product.id %>">
</form>
//add to cart button이 있는 다른 모든 곳에 적용.
```

```jsx
//router의 shop.js
router.post('/cart', ShopController.postCart);
```

```jsx
//controller의 shop.js
exports const postCart = (req, res, next) => {
	const prodId = req.body.productID;
	console.log(prodID);
	res.redirect('/cart/);
};
```

## 쿼리 변수 사용

기존의 상품을 편집하고 싶음: 전달해야 할 ID와 상품을 생성하는 대신 편집하고 싶다는 정보 필요

```jsx
//routes의 admin.js
router.get('/edit-product/:productId', adminController.getEditPRoduct);
//:로 나타낸 동적 경로 세그먼트 
```

```jsx
//controllers의 admin.js
//getEditProduct 안
const editMode = req.query.edit;
if (!editMode) {
	res.redirect('/');
}
editing: editMode
```